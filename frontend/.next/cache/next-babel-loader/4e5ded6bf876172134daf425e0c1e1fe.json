{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\ducp1\\\\Desktop\\\\journalProject\\\\frontend\\\\pages\\\\journals\\\\index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n//build-in component for sticking elements to 'head' of the page\nimport Link from 'next/link';\nimport Layout from '../../components/Layout';\nimport { useState } from 'react';\nimport { listJournals } from '../../actions/journal';\nimport { API, APP_NAME, DOMAIN } from '../../config';\nimport renderHTML from 'react-render-html';\nimport moment from 'moment';\nimport SingleJournal from '../../components/Journal/SingleJournal'; //need to write a metatitle and meta description,opengraph title descrip\n\nvar Journal = function Journal(_ref) {\n  var journals = _ref.journals,\n      categories = _ref.categories,\n      tags = _ref.tags,\n      journalTotal = _ref.journalTotal,\n      journalLimit = _ref.journalLimit,\n      journalSkip = _ref.journalSkip;\n\n  //keeping track of journal limit,skip and size\n  var _useState = useState(journalLimit),\n      limit = _useState[0],\n      setLimit = _useState[1];\n\n  var _useState2 = useState(journalSkip),\n      skip = _useState2[0],\n      setSkip = _useState2[1];\n\n  var _useState3 = useState(journalTotal),\n      size = _useState3[0],\n      setSize = _useState3[1]; //loaded blogs are kept tracked\n\n\n  var _useState4 = useState([]),\n      loadedJournals = _useState4[0],\n      setloadedJournals = _useState4[1]; //existed blogs will be skipped\n\n\n  var loadMoreJournals = function loadMoreJournals() {\n    //skip existing journals\n    var toSkip = skip + limit;\n    listJournals(toSkip, limit).then(function (data) {\n      if (data.error) {\n        console.log(error);\n      } else {\n        setloadedJournals([].concat(_toConsumableArray(loadedJournals), _toConsumableArray(data.journals)));\n        setSkip(toSkip);\n        setSize(data.size);\n      }\n    });\n  };\n\n  var loadMoreButton = function loadMoreButton() {\n    return size > 0 && size >= limit && __jsx(\"button\", {\n      onClick: loadMoreJournals(),\n      className: \"btn btn-primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, \"Load More\");\n  };\n\n  var showAllCategories = function showAllCategories() {\n    return categories.map(function (category, index) {\n      return __jsx(Link, {\n        key: index,\n        href: \"/categories/\".concat(category.slug),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 47\n        },\n        __self: this\n      }, __jsx(\"a\", {\n        className: \"btn btn-primary mr-1 ml-1 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48\n        },\n        __self: this\n      }, category.name));\n    });\n  };\n\n  var showAllJournals = function showAllJournals() {\n    return journals.map(function (journal, index) {\n      return __jsx(\"article\", {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56\n        },\n        __self: this\n      }, __jsx(SingleJournal, {\n        journal: journal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }), __jsx(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }));\n    });\n  };\n\n  var showMoreJournals = function showMoreJournals() {\n    return loadedJournals.map(function (journal, index) {\n      return __jsx(\"article\", {\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, __jsx(SingleJournal, {\n        journal: journal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }), __jsx(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }));\n    });\n  };\n\n  return __jsx(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, __jsx(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"container-fluid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, __jsx(\"header\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"col-md-12 pt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"display-4 font-weight-bold text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, \"Journals\")), __jsx(\"section\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"display-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"Journal Categories: \", showAllCategories(), \" \")), __jsx(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }))), __jsx(\"div\", {\n    className: \"container-fluid\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"col-md-12\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, showAllJournals(), showMoreJournals(), loadMoreButton()))))));\n}; //using lifecycle method\n//request sent to backend\n\n\nJournal.getInitialProps = function () {\n  var skip = 0;\n  var limit = 2;\n  return listJournals(skip, limit).then(function (data) {\n    if (data.error) {\n      console.log(data.error);\n    } else {\n      //return properties from response\n      //props can be passed to funtion to be rendered\n      return {\n        journals: data.journals,\n        categories: data.categories,\n        tags: data.tags,\n        journalTotal: data.size,\n        journalLimit: limit,\n        journalSkip: skip\n      };\n    }\n  });\n};\n\nexport default Journal; //getInitialProps: server-side rendered method. Can only be used on pages, not in the components\n//server side render the page","map":{"version":3,"sources":["C:/Users/ducp1/Desktop/journalProject/frontend/pages/journals/index.js"],"names":["Link","Layout","useState","listJournals","API","APP_NAME","DOMAIN","renderHTML","moment","SingleJournal","Journal","journals","categories","tags","journalTotal","journalLimit","journalSkip","limit","setLimit","skip","setSkip","size","setSize","loadedJournals","setloadedJournals","loadMoreJournals","toSkip","then","data","error","console","log","loadMoreButton","showAllCategories","map","category","index","slug","name","showAllJournals","journal","showMoreJournals","getInitialProps"],"mappings":"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","sourcesContent":["//build-in component for sticking elements to 'head' of the page\r\nimport Link from 'next/link'\r\nimport Layout from '../../components/Layout'\r\nimport {useState} from 'react'\r\nimport {listJournals} from '../../actions/journal'\r\nimport {API,APP_NAME,DOMAIN} from '../../config'\r\nimport renderHTML from 'react-render-html'\r\nimport moment from 'moment'\r\nimport SingleJournal from '../../components/Journal/SingleJournal'\r\n//need to write a metatitle and meta description,opengraph title descrip\r\n\r\nconst Journal = ({journals,categories,tags,journalTotal,journalLimit,journalSkip}) => {\r\n\t//keeping track of journal limit,skip and size\r\n\tconst [limit,setLimit]=useState(journalLimit)\r\n\tconst [skip,setSkip]=useState(journalSkip)\r\n\tconst [size,setSize]=useState(journalTotal)\r\n\t//loaded blogs are kept tracked\r\n\tconst [loadedJournals,setloadedJournals] = useState([])\r\n\r\n\r\n//existed blogs will be skipped\r\n\tconst loadMoreJournals = () => {\r\n\t\t//skip existing journals\r\n\t\tlet toSkip = skip + limit\r\n\t\tlistJournals(toSkip,limit).then(data=>{\r\n\t\t\tif(data.error){\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t} else {\r\n\t\t\t\tsetloadedJournals([...loadedJournals,...data.journals])\r\n\t\t\t\tsetSkip(toSkip)\r\n\t\t\t\tsetSize(data.size)\r\n\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tconst loadMoreButton = () => {\r\n\t\treturn (\r\n\t\t\tsize > 0 && size >= limit && (\r\n\t\t\t\t<button onClick={loadMoreJournals()} className=\"btn btn-primary\">Load More</button>\r\n\t\t\t)\r\n\t\t)\r\n\t}\r\n\r\n\tconst showAllCategories = () => {\r\n\t\treturn categories.map((category,index)=>{\r\n\t\t\treturn <Link key={index} href={`/categories/${category.slug}`}>\r\n\t\t\t\t<a className=\"btn btn-primary mr-1 ml-1 mt-3\">{category.name}</a>\r\n\t\t\t</Link>\r\n\t\t})\r\n\t}\r\n\r\n\r\n\tconst showAllJournals = () => {\r\n\t\treturn journals.map((journal,index)=>{\r\n\t\t\treturn <article key={index}>\r\n\t\t\t\t<SingleJournal journal={journal} />\r\n\t\t\t\t<hr/>\r\n\t\t\t</article>\r\n\t\t})\r\n\t}\r\n\r\n\tconst showMoreJournals = () => {\r\n\t\treturn loadedJournals.map((journal,index)=>{\r\n\t\t\treturn <article key={index}>\r\n\t\t\t\t<SingleJournal journal={journal}/>\r\n\t\t\t\t<hr/>\r\n\t\t\t</article>\r\n\t\t})\r\n\t}\r\n\r\n\treturn(\r\n\t\t<React.Fragment>\r\n\t\t\t<Layout>\r\n\t\t\t\t<main>\r\n\t\t\t\t\t<div className=\"container-fluid\">\r\n\t\t\t\t\t<header>\r\n\t\t\t\t\t\t<div className=\"col-md-12 pt-3\">\r\n\t\t\t\t\t\t\t<h1 className=\"display-4 font-weight-bold text-center\">Journals</h1>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<section>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div className=\"display-4\">Journal Categories: {showAllCategories()} </div>\r\n\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"container-fluid\">\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t<div className=\"col-md-12\">\r\n\t\t\t\t\t\t{showAllJournals()}\r\n\t\t\t\t\t\t{showMoreJournals()}\r\n\t\t\t\t\t\t{loadMoreButton()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</main>\r\n\t\t\t</Layout>\r\n\t\t</React.Fragment>\r\n\t)\r\n}\r\n\r\n//using lifecycle method\r\n//request sent to backend\r\nJournal.getInitialProps = () => {\r\n\r\n\tlet skip=0\r\n\tlet limit=2\r\n\r\n\treturn listJournals(skip,limit).then(data=>{\r\n\t\tif (data.error) {\r\n\t\t\tconsole.log(data.error)\r\n\t\t} else {\r\n\t\t\t//return properties from response\r\n\t\t\t//props can be passed to funtion to be rendered\r\n\t\t\treturn {\r\n\t\t\t\tjournals: data.journals,\r\n\t\t\t\tcategories: data.categories,\r\n\t\t\t\ttags: data.tags,\r\n\t\t\t\tjournalTotal: data.size,\r\n\t\t\t\tjournalLimit: limit,\r\n\t\t\t\tjournalSkip: skip\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n}\r\n\r\n\r\n\r\nexport default Journal\r\n\r\n//getInitialProps: server-side rendered method. Can only be used on pages, not in the components\r\n//server side render the page"]},"metadata":{},"sourceType":"module"}