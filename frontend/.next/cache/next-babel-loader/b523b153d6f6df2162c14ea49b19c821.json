{"ast":null,"code":"var _jsxFileName = \"D:\\\\journalProject\\\\frontend\\\\pages\\\\member\\\\account-validate\\\\[token].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Layout from '../../../components/Layout';\nimport { useState, useEffect } from 'react';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { register, login } from '../../../actions/auth';\nimport { withRouter } from 'next/router';\nimport Router from 'next/router';\n\nconst AccountValidation = ({\n  router\n}) => {\n  const {\n    0: modal,\n    1: setModal\n  } = useState(false);\n\n  const toggle = () => setModal(!modal);\n\n  const registerMember = () => {\n    const accountValidationLink = router.query.token;\n    console.log(JSON.stringify(accountValidationLink));\n    register({\n      accountValidationLink\n    }).then(data => {\n      if (data.error) {\n        alert(data.error);\n      } else {\n        const {\n          email,\n          password\n        } = data;\n        let member = {\n          email,\n          password\n        };\n        login(member).then(member => {\n          if (member.error) {\n            setValues(_objectSpread({}, values, {\n              error: member.error,\n              loading: false\n            }));\n            console.log(message.error);\n          } else {\n            //save user token to cookie\n            //save user info to local storage\n            //authenticate user\n            //redirect user to homepage\n            authenticate(member, () => {\n              if (isLoggedIn() && isLoggedIn().role === 'admin') {\n                Router.push(`/admin`);\n              } else {\n                Router.push(`/member`);\n              }\n            });\n          }\n        });\n      }\n    });\n  };\n\n  const showForm = () => {\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, __jsx(Button, {\n      color: \"primary\",\n      onClick: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, \"Activate your account\"), __jsx(Modal, {\n      isOpen: modal,\n      toggle: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, __jsx(ModalHeader, {\n      toggle: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, \"Welcome to Everly\"), __jsx(ModalBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, \"Be ready to journaling your journey\"), __jsx(ModalFooter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, __jsx(Button, {\n      color: \"primary\",\n      onClick: registerMember,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, \"Do Something\"))));\n  };\n\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"mt-2 mb-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }, \"Ready to activate your account ?\"), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }), showForm()));\n};\n\nexport default withRouter(AccountValidation); //onclick => register account","map":{"version":3,"sources":["D:/journalProject/frontend/pages/member/account-validate/[token].js"],"names":["Layout","useState","useEffect","Button","Modal","ModalHeader","ModalBody","ModalFooter","register","login","withRouter","Router","AccountValidation","router","modal","setModal","toggle","registerMember","accountValidationLink","query","token","console","log","JSON","stringify","then","data","error","alert","email","password","member","setValues","values","loading","message","authenticate","isLoggedIn","role","push","showForm"],"mappings":"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","sourcesContent":["import Layout from '../../../components/Layout'\r\nimport {useState,useEffect} from 'react'\r\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\r\nimport {register,login} from '../../../actions/auth'\r\nimport {withRouter} from 'next/router'\r\nimport Router from 'next/router'\r\n\r\nconst AccountValidation = ({router}) => {\r\n\r\nconst [modal, setModal] = useState(false);\r\n\r\nconst toggle = () => setModal(!modal);\r\n\r\nconst registerMember = () => {\r\n  const accountValidationLink = router.query.token\r\n  console.log(JSON.stringify(accountValidationLink))\r\n  register({accountValidationLink}).then(data=>{\r\n    if(data.error){ \r\n      alert(data.error)\r\n    } else {\r\n      const {email,password} = data\r\n      let member = {email,password}\r\n       login(member).then(member => {\r\n            if (member.error) {\r\n                setValues({ ...values, error: member.error, loading: false });\r\n                console.log(message.error)\r\n            } else {\r\n              //save user token to cookie\r\n              //save user info to local storage\r\n              //authenticate user\r\n              //redirect user to homepage\r\n              authenticate(member, () => {\r\n                if(isLoggedIn() && isLoggedIn().role ==='admin'){\r\n                  Router.push(`/admin`)\r\n                } else {\r\n                  Router.push(`/member`)\r\n                }\r\n              })\r\n            }\r\n        });\r\n\r\n    }\r\n  })\r\n}\r\n\r\nconst showForm = () => {\r\n\treturn (\r\n\t   <div>\r\n      <Button color=\"primary\" onClick={toggle}>Activate your account</Button>\r\n      <Modal isOpen={modal} toggle={toggle}>\r\n        <ModalHeader toggle={toggle}>Welcome to Everly</ModalHeader>\r\n        <ModalBody>\r\n          Be ready to journaling your journey\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color=\"primary\" onClick={registerMember}>Do Something</Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </div>\r\n\t)\r\n}\r\n\r\n return (\r\n \t<Layout>\r\n \t\t<div className=\"text-center\">\r\n\t \t\t<h1 className=\"mt-2 mb-2\">Ready to activate your account ?</h1>\r\n\t \t\t<hr/>\r\n\t \t\t{showForm()}\r\n \t\t</div>\r\n \t</Layout>\r\n )\r\n}\r\n\r\nexport default withRouter(AccountValidation)\r\n\r\n//onclick => register account"]},"metadata":{},"sourceType":"module"}