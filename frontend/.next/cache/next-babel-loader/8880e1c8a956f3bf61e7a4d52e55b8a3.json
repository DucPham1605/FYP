{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"D:\\\\journalProject\\\\frontend\\\\pages\\\\member\\\\account-validate\\\\[token].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Layout from '../../../components/Layout';\nimport { useState } from 'react';\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\nimport { register, login } from '../../../actions/auth';\nimport { withRouter } from 'next/router';\nimport Router from 'next/router';\nimport { authenticate, isLoggedIn } from '../../../actions/handleCookie';\n\nvar AccountValidation = function AccountValidation(_ref) {\n  var router = _ref.router;\n\n  var _useState = useState(false),\n      modal = _useState[0],\n      setModal = _useState[1];\n\n  var toggle = function toggle() {\n    return setModal(!modal);\n  };\n\n  var registerMember = function registerMember() {\n    var accountValidationLink = router.query.token;\n    console.log(_JSON$stringify(accountValidationLink));\n    register({\n      accountValidationLink: accountValidationLink\n    }).then(function (data) {\n      if (data.error) {\n        alert(data.error);\n      } else {\n        var email = data.email,\n            password = data.password;\n        var member = {\n          email: email,\n          password: password\n        };\n        login(member).then(function (member) {\n          if (member.error) {\n            setValues(_objectSpread({}, values, {\n              error: member.error,\n              loading: false\n            }));\n            console.log(message.error);\n          } else {\n            authenticate(member, function () {\n              if (isLoggedIn() && isLoggedIn().role === 'admin') {\n                Router.push(\"/admin\");\n              } else {\n                Router.push(\"/member\");\n              }\n            });\n          }\n        });\n      }\n    });\n  };\n\n  var showForm = function showForm() {\n    return __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, __jsx(Button, {\n      color: \"primary\",\n      onClick: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    }, \"Activate your account\"), __jsx(Modal, {\n      isOpen: modal,\n      toggle: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46\n      },\n      __self: this\n    }, __jsx(ModalHeader, {\n      toggle: toggle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47\n      },\n      __self: this\n    }, \"Welcome to Everly\"), __jsx(ModalBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, \"Be ready to journaling your journey\"), __jsx(ModalFooter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51\n      },\n      __self: this\n    }, __jsx(Button, {\n      color: \"primary\",\n      onClick: registerMember,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, \"Do Something\"))));\n  };\n\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, __jsx(\"h1\", {\n    className: \"mt-2 mb-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"Ready to activate your account ?\"), __jsx(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), showForm()));\n};\n\nexport default withRouter(AccountValidation); //onclick => register account","map":{"version":3,"sources":["D:/journalProject/frontend/pages/member/account-validate/[token].js"],"names":["Layout","useState","Button","Modal","ModalHeader","ModalBody","ModalFooter","register","login","withRouter","Router","authenticate","isLoggedIn","AccountValidation","router","modal","setModal","toggle","registerMember","accountValidationLink","query","token","console","log","then","data","error","alert","email","password","member","setValues","values","loading","message","role","push","showForm"],"mappings":"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","sourcesContent":["import Layout from '../../../components/Layout'\r\nimport {useState} from 'react'\r\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from 'reactstrap';\r\nimport {register,login} from '../../../actions/auth'\r\nimport {withRouter} from 'next/router'\r\nimport Router from 'next/router'\r\nimport {authenticate,isLoggedIn} from '../../../actions/handleCookie'\r\n\r\nconst AccountValidation = ({router}) => {\r\n\r\nconst [modal, setModal] = useState(false);\r\n\r\nconst toggle = () => setModal(!modal);\r\n\r\nconst registerMember = () => {\r\n  const accountValidationLink = router.query.token\r\n  console.log(JSON.stringify(accountValidationLink))\r\n  register({accountValidationLink}).then(data=>{\r\n    if(data.error){ \r\n      alert(data.error)\r\n    } else {\r\n      const {email,password} = data\r\n      let member = {email,password}\r\n       login(member).then(member => {\r\n            if (member.error) {\r\n                setValues({ ...values, error: member.error, loading: false });\r\n                console.log(message.error)\r\n            } else {\r\n              authenticate(member, () => {\r\n                if(isLoggedIn() && isLoggedIn().role ==='admin'){\r\n                  Router.push(`/admin`)\r\n                } else {\r\n                  Router.push(`/member`)\r\n                }\r\n              })\r\n            }\r\n        });\r\n    }\r\n  })\r\n}\r\n\r\nconst showForm = () => {\r\n\treturn (\r\n\t   <div>\r\n      <Button color=\"primary\" onClick={toggle}>Activate your account</Button>\r\n      <Modal isOpen={modal} toggle={toggle}>\r\n        <ModalHeader toggle={toggle}>Welcome to Everly</ModalHeader>\r\n        <ModalBody>\r\n          Be ready to journaling your journey\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button color=\"primary\" onClick={registerMember}>Do Something</Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </div>\r\n\t)\r\n}\r\n\r\n return (\r\n \t<Layout>\r\n \t\t<div className=\"text-center\">\r\n\t \t\t<h1 className=\"mt-2 mb-2\">Ready to activate your account ?</h1>\r\n\t \t\t<hr/>\r\n\t \t\t{showForm()}\r\n \t\t</div>\r\n \t</Layout>\r\n )\r\n}\r\n\r\nexport default withRouter(AccountValidation)\r\n\r\n//onclick => register account"]},"metadata":{},"sourceType":"module"}